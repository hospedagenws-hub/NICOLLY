<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NICÓLLY SAVOY | E-book O Poder do Primeiro Passo</title>
  <meta name="description" content="Agende serviços no WhatsApp ou compre o e-book O Poder do Primeiro Passo de NICÓLLY SAVOY." />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
    }
  </style>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>:root{--brand-from:#7db710;--brand-to:#71a50e}</style>
</head>
<body class="bg-gray-50 text-gray-800">

  <!-- HERO / BANNER -->
  <header class="relative overflow-hidden">
    <div class="relative">
      <img
        id="heroPhoto"
        src="banner-nicolly.jpg"
        alt="Foto de NICÓLLY SAVOY"
        class="w-full h-[320px] md:h-[420px] lg:h-[500px] object-cover"
      />
      <div class="absolute inset-0 bg-gradient-to-br from-black/70 via-black/40 to-emerald-700/60"></div>

      <div class="absolute inset-0">
        <div class="container mx-auto px-6 py-10 flex flex-col justify-center max-w-3xl text-white">
          <div class="flex items-center gap-3">
            <span class="text-white text-2xl md:text-3xl font-extrabold">NICÓLLY SAVOY</span>
          </div>
          <p class="uppercase tracking-widest text-white/80 text-sm mt-3">MOTIVAÇÃO PARA TREINO</p>
          <h1 class="text-4xl md:text-6xl font-extrabold leading-tight">O Poder do Primeiro Passo</h1>
          <p class="mt-4 text-lg md:text-xl text-white/90">
            Você não tem preguiça de fazer exercício físico, só não aprendeu a driblar a inércia.
            Nesse e-book você vai aprender a fazer isso de forma muito simples. Aproveite bem sua leitura!
          </p>
          <div class="mt-8 flex flex-wrap gap-3">
            <a href="https://wa.me/5575981595225?text=Ol%C3%A1!%20Quero%20falar%20com%20NIC%C3%93LLY%20SAVOY"
               target="_blank" rel="noopener"
               class="inline-flex items-center gap-2 rounded-2xl bg-white text-emerald-700 font-semibold px-6 py-3 shadow hover:shadow-lg">
              Falar no WhatsApp
            </a>
            <a href="#produto"
               class="inline-flex items-center gap-2 rounded-2xl bg-white/10 text-white font-semibold px-6 py-3 border border-white/30 hover:bg-white/20">
              Ver e-book
            </a>
            <a href="https://instagram.com/nicoly_fitt" target="_blank" rel="noopener"
               class="inline-flex items-center gap-2 rounded-2xl bg-white/10 text-white font-semibold px-4 py-3 border border-white/30 hover:bg-white/20"
               aria-label="Instagram">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                   viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2.2c3.2 0 3.6 0 4.9.1 1.2.1 2 .2 2.5.4.6.2 1 .4 1.4.8.4.4.6.8.8 1.4.2.5.3 1.3.4 2.5.1 1.3.1 1.7.1 4.9s0 3.6-.1 4.9c-.1 1.2-.2 2-.4 2.5-.2.6-.4 1-.8 1.4-.4.4-.8.6-1.4.8-.5.2-1.3.3-2.5.4-1.3.1-1.7.1-4.9.1s-3.6 0-4.9-.1c-1.2-.1-2-.2-2.5-.4-.6-.2-1-.4-1.4-.8-.4-.4-.6-.8-.8-1.4-.2-.5-.3-1.3-.4-2.5C2.2 15.6 2.2 15.2 2.2 12s0-3.6.1-4.9c.1-1.2.2-2 .4-2.5.2-.6.4-1 .8-1.4.4-.4.8-.6 1.4-.8.5-.2 1.3-.3 2.5-.4C8.4 2.2 8.8 2.2 12 2.2Zm0 1.8c-3.1 0-3.5 0-4.7.1-1 .1-1.5.2-1.8.3-.4.2-.7.3-1 .6-.3.3-.5.6-.6 1-.1.3-.3.8-.3 1.8-.1 1.2-.1 1.6-.1 4.7s0 3.5.1 4.7c.1 1 .2 1.5.3 1.8.2.4.3.7.6 1 .3.3.6.5 1 .6.3.1.8.3 1.8.3 1.2.1 1.6.1 4.7.1s3.5 0 4.7-.1c1 0 1.5-.2 1.8-.3.4-.2.7-.3 1-.6.3-.3.5-.6.6-1 .1-.3.3-.8.3-1.8.1-1.2.1-1.6.1-4.7s0-3.5-.1-4.7c0-1-.2-1.5-.3-1.8-.2-.4-.3-.7-.6-1-.3-.3-.6-.5-1-.6-.3-.1-.8-.3-1.8-.3-1.2-.1-1.6-.1-4.7-.1Zm0 3.2a6.8 6.8 0 1 1 0 13.6 6.8 6.8 0 0 1 0-13.6Zm0 1.8a5 5 0 1 0 0 10 5 5 0 0 0 0-10Zm5.3-.9a1.3 1.3 0 1 1 0 2.6 1.3 1.3 0 0 1 0-2.6Z"/>
              </svg>
              <span>@nicoly_fitt</span>
            </a>
          </div>
        </div>
      </div>

      <input id="fotoInput" type="file" accept="image/*" class="hidden" />
    </div>
  </header>

  <!-- VANTAGENS -->
  <section class="container mx-auto px-6 py-10 grid grid-cols-1 md:grid-cols-3 gap-4">
    <div class="p-6 bg-white rounded-2xl shadow">
      <h3 class="font-bold text-lg">Atendimento ágil</h3>
      <p class="text-gray-600">Fale direto no WhatsApp. Sem filas.</p>
    </div>
    <div class="p-6 bg-white rounded-2xl shadow">
      <h3 class="font-bold text-lg">Localização fácil</h3>
      <p class="text-gray-600">Clique em "Como chegar" e venha com segurança.</p>
    </div>
    <div class="p-6 bg-white rounded-2xl shadow">
      <h3 class="font-bold text-lg">Serviços transparentes</h3>
      <p class="text-gray-600">Lista com valores “a partir de”.</p>
    </div>
  </section>

  <!-- PRODUTO / E-BOOK PRINCIPAL -->
  <section id="produto" class="container mx-auto px-6 py-10">
    <h2 class="text-2xl md:text-3xl font-extrabold mb-6">E-book: O Poder do Primeiro Passo</h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start">
      <!-- FOTO DO PRODUTO -->
      <div class="flex flex-col items-center">
        <img
          id="produtoFoto"
          src="capa-ebook-nicolly.jpg"
          alt="Capa do e-book O Poder do Primeiro Passo"
          class="w-full max-w-xs rounded-2xl shadow-lg object-cover mb-3"
        />
        <input id="produtoFotoInput" type="file" accept="image/*" class="hidden" />
      </div>

      <!-- DETALHES + PAGAMENTO -->
      <div>
        <p class="text-gray-700 mb-3">
          E-book prático e direto ao ponto para te ajudar a sair da inércia e desenvolver o hábito
          de fazer atividade física no dia a dia, mesmo com rotina corrida.
        </p>

        <p class="text-sm text-gray-500 line-through mb-1">De R$ 49,90</p>
        <p class="text-2xl font-bold text-emerald-700 mb-1">Por R$ 29,90</p>
        <p class="text-sm text-gray-500 mb-4">Pagamento via Mercado Pago (Pix, cartão ou boleto).</p>

        <!-- Campo referência do cliente -->
        <div class="mb-4 space-y-2">
          <label for="refCliente" class="block text-xs font-semibold text-gray-700">
            Seu WhatsApp (apenas números) ou e-mail para liberar o e-book:
          </label>
          <input
            id="refCliente"
            type="text"
            class="w-full rounded-xl border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500"
            placeholder="Ex: 75981595225 ou seuemail@gmail.com"
          />
          <p class="text-[11px] text-gray-500">
            Usamos esse dado apenas para confirmar o pagamento no Mercado Pago.
          </p>
        </div>

        <!-- Botões principais -->
        <div class="flex flex-wrap gap-2">
          <button
            id="btnGerarPagamento"
            class="inline-flex items-center gap-2 rounded-2xl bg-emerald-600 text-white font-semibold px-6 py-3 shadow hover:bg-emerald-700">
            Gerar link de pagamento
          </button>

          <button
            id="btnMostrarQr"
            type="button"
            class="inline-flex items-center gap-2 rounded-2xl bg-white text-emerald-700 border border-emerald-600 font-semibold px-4 py-3 shadow-sm hover:bg-emerald-50">
            Ver QR Code (Pix fixo)
          </button>
        </div>

        <!-- Área com link gerado + copiar -->
        <div id="areaLinkPagamento" class="mt-4 hidden">
          <p class="text-sm text-gray-700 mb-2">
            Link de pagamento gerado. Você pode abrir ou copiar:
          </p>
          <div class="flex flex-col sm:flex-row gap-2">
            <input
              id="linkPagamentoInput"
              type="text"
              readonly
              class="flex-1 rounded-xl border border-gray-300 px-3 py-2 text-xs bg-gray-50"
            />
            <button
              id="btnCopiarLink"
              type="button"
              class="rounded-xl bg-gray-900 text-white text-xs font-semibold px-4 py-2 hover:bg-black">
              Copiar link
            </button>
          </div>
          <button
            id="btnAbrirLink"
            type="button"
            class="mt-2 rounded-xl bg-emerald-600 text-white text-sm font-semibold px-4 py-2 hover:bg-emerald-700">
            Abrir página de pagamento
          </button>
        </div>

        <!-- Botão para verificar pagamento -->
        <div class="mt-5">
          <button
            id="btnVerificarPagamento"
            type="button"
            class="rounded-2xl bg-emerald-700 text-white font-semibold px-6 py-2 shadow hover:bg-emerald-800 text-sm">
            Já paguei, verificar e liberar e-book
          </button>
          <p id="ebookAviso" class="mt-2 text-[11px] text-gray-500">
            Após pagar pelo link, clique em <span class="font-semibold">"Já paguei, verificar e liberar e-book"</span>.
          </p>
        </div>

        <!-- Área do e-book (liberada após pagamento aprovado OU manualmente pelo QR fixo) -->
        <div id="ebookArea" class="mt-6 hidden">
          <h3 class="font-semibold text-lg mb-2">Download do e-book</h3>
          <p class="text-gray-600 text-sm mb-3">
            Pagamento confirmado. Clique abaixo para baixar seu e-book:
          </p>
          <a
            id="ebookLink"
            href="ebook-nicolly.pdf"
            download
            class="inline-flex items-center gap-2 rounded-2xl bg-emerald-600 text-white font-semibold px-5 py-2 shadow hover:bg-emerald-700">
            Baixar e-book em PDF
          </a>
          <p class="mt-2 text-[11px] text-gray-500">
            Se o download não iniciar, envie o comprovante pelo WhatsApp e nós ajudamos você.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- MODAL COM QR CODE FIXO (sem confirmação automática) -->
  <div
    id="qrModal"
    class="fixed inset-0 bg-black/60 flex items-center justify-center px-4 hidden z-50"
  >
    <div class="bg-white rounded-2xl shadow-xl max-w-sm w-full p-6 relative">
      <button
        id="btnFecharQr"
        class="absolute top-3 right-3 text-gray-400 hover:text-gray-600 text-sm"
      >
        ✕
      </button>
      <h3 class="text-lg font-bold mb-1">Pix fixo – Plataforma WS</h3>
      <p class="text-sm text-gray-600 mb-1">Vendido por: <strong>NICÓLLY SAVOY</strong></p>
      <p class="text-sm text-gray-600 mb-1">Favorecido: <strong>Warley de Jesus Santos</strong></p>
      <p class="text-xs text-gray-500 mb-3">
        Este Pix fixo não faz liberação automática. Após pagar, clique em "Já paguei, verificar" ou envie o comprovante no WhatsApp.
      </p>

      <div class="flex justify-center mb-3">
        <img
          id="qrImage"
          src="qr-nicolly.jpg"
          alt="QR Code Mercado Pago"
          class="w-72 h-72 object-contain rounded border"
        />
        <input id="qrInput" type="file" accept="image/*" class="hidden" />
      </div>

      <button
        id="btnJaPaguei"
        class="w-full rounded-xl bg-emerald-600 text-white font-semibold py-2 mt-2 hover:bg-emerald-700"
      >
        Já paguei usando este QR
      </button>
      <p class="text-[11px] text-gray-500 mt-3">
        *Liberação pelo QR fixo ainda é manual (confia no cliente).
        A confirmação real é feita quando você usa o link de pagamento criado pelo botão acima.
      </p>
    </div>
  </div>

  <!-- DEPOIMENTOS + ADMIN (igual antes) -->
  <section class="bg-white/60 py-12 mt-6">
    <div class="container mx-auto px-6">
      <h2 class="text-2xl md:text-3xl font-extrabold mb-6">O que nossas clientes dizem</h2>

      <div id="depoimentosGrid" class="grid grid-cols-1 md:grid-cols-3 gap-6"></div>

      <div class="mt-10 max-w-xl mx-auto bg-white rounded-2xl shadow p-6">
        <h3 class="font-bold text-lg mb-4">Envie seu depoimento</h3>
        <form id="formDepoimento" class="space-y-3">
          <div>
            <label class="block text-sm font-medium text-gray-700" for="nomeCliente">Seu nome</label>
            <input id="nomeCliente" type="text" required
                   class="mt-1 w-full rounded-xl border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700" for="textoDepoimento">Depoimento</label>
            <textarea id="textoDepoimento" required rows="3"
                      class="mt-1 w-full rounded-xl border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500"></textarea>
          </div>
          <button type="submit"
                  class="inline-flex items-center justify-center rounded-xl bg-emerald-600 text-white text-sm font-semibold px-4 py-2 hover:bg-emerald-700">
            Enviar depoimento
          </button>
          <p class="text-xs text-gray-500 mt-1">
            Seu depoimento pode aparecer na página após aprovação.
          </p>
        </form>
      </div>

      <div id="adminPanel" class="mt-6 max-w-xl mx-auto bg-gray-900 text-gray-100 rounded-2xl p-5 hidden">
        <h3 class="font-semibold mb-3">Modo administrador</h3>
        <p class="text-sm text-gray-300 mb-3">
          Digite a senha para ativar o modo admin (trocar imagens e excluir depoimentos).
        </p>
        <div class="flex flex-col sm:flex-row gap-2 items-start sm:items-center">
          <input id="adminSenha" type="password" placeholder="Senha do administrador"
                 class="w-full sm:flex-1 rounded-xl border border-gray-600 bg-gray-800 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500">
          <button id="btnAtivarAdmin" class="mt-2 sm:mt-0 inline-flex items-center rounded-xl bg-emerald-600 px-4 py-2 text-sm font-semibold hover:bg-emerald-700">
            Ativar modo admin
          </button>
        </div>
        <p id="adminStatus" class="text-xs mt-2 text-gray-400">
          Modo admin: <span class="font-semibold">desativado</span>
        </p>

        <div id="adminMediaButtons" class="mt-4 hidden text-xs space-y-2">
          <p class="text-gray-300 font-semibold">Imagens:</p>
          <div class="flex flex-wrap gap-2">
            <button id="btnTrocarBanner"
                    class="px-3 py-1 rounded-lg bg-gray-800 hover:bg-gray-700 border border-gray-700">
              Trocar foto do banner
            </button>
            <button id="btnTrocarProduto"
                    class="px-3 py-1 rounded-lg bg-gray-800 hover:bg-gray-700 border border-gray-700">
              Trocar capa do e-book
            </button>
            <button id="btnTrocarQr"
                    class="px-3 py-1 rounded-lg bg-gray-800 hover:bg-gray-700 border border-gray-700">
              Trocar QR Code
            </button>
          </div>
          <p class="text-gray-500">
            As imagens ficam salvas apenas no seu navegador (localStorage).
          </p>
        </div>

        <p class="text-[11px] text-gray-500 mt-3">
          Para exibir este painel, acesse a página com <code>?admin=1</code> no final da URL.<br>
          Exemplo: <code>index.html?admin=1</code>
        </p>
      </div>
    </div>
  </section>

  <!-- CTA WHATSAPP -->
  <section class="container mx-auto px-6 py-14 text-center">
    <h2 class="text-3xl md:text-4xl font-extrabold">Chame no WhatsApp</h2>
    <p class="text-gray-600 mt-3">Clique abaixo e fale com a nossa equipe.</p>
    <a href="https://wa.me/5575981595225?text=Ol%C3%A1!%20Quero%20falar%20com%20NIC%C3%93LLY%20SAVOY"
       target="_blank" rel="noopener"
       class="inline-flex items-center gap-2 rounded-2xl bg-emerald-600 text-white font-semibold px-8 py-4 mt-6 shadow hover:bg-emerald-700">
      Agendar agora
    </a>
  </section>

  <!-- RODAPÉ -->
  <footer class="bg-gray-900 text-gray-300">
    <div class="container mx-auto px-6 py-10 grid grid-cols-1 md:grid-cols-3 gap-6">
      <div>
        <h3 class="font-bold text-white">NICÓLLY SAVOY</h3>
        <p class="text-gray-400 mt-2">O PODER DO PRIMEIRO PASSO</p>
      </div>
      <div>
        <h4 class="font-semibold text-white">Endereço</h4>
        <p class="text-gray-400 mt-2">Feira de Santana - BA (exemplo)</p>
        <a class="text-emerald-400 hover:text-emerald-300"
           href="https://www.google.com/maps/search/?api=1&query=Feira+de+Santana+BA"
           target="_blank" rel="noopener">
          Como chegar
        </a>
      </div>
      <div>
        <h4 class="font-semibold text-white">Contato</h4>
        <p class="text-gray-400 mt-2">WhatsApp: (75) 98159-5225</p>
        <p class="text-gray-400">
          Instagram:
          <a class="text-emerald-400 hover:text-emerald-300"
             href="https://instagram.com/nicoly_fitt"
             target="_blank" rel="noopener">
             @nicoly_fitt
          </a>
        </p>
      </div>
    </div>
    <div class="text-center text-gray-500 pb-6">
      © 2025 NICÓLLY SAVOY – Todos os direitos reservados. Plataforma WS.
    </div>
  </footer>

  <!-- SCRIPT -->
  <script>
    // ========= CONFIG BACKEND =========
    // TROCAR pela URL real do backend (Render / Railway etc.)
    const BACKEND_URL = "https://SEU-BACKEND-AQUI.com";

    // ===== MOSTRAR PAINEL ADMIN SÓ COM ?admin=1 =====
    const adminPanel       = document.getElementById('adminPanel');
    const params           = new URLSearchParams(window.location.search);
    const isAdminPage      = params.get('admin') === '1';
    if (adminPanel && isAdminPage) {
      adminPanel.classList.remove('hidden');
    }

    // ===== ELEMENTOS GERAIS =====
    const heroPhoto        = document.getElementById('heroPhoto');
    const fotoInput        = document.getElementById('fotoInput');

    const produtoFoto      = document.getElementById('produtoFoto');
    const produtoFotoInput = document.getElementById('produtoFotoInput');

    const qrImage          = document.getElementById('qrImage');
    const qrInput          = document.getElementById('qrInput');

    const qrModal          = document.getElementById('qrModal');
    const btnMostrarQr     = document.getElementById('btnMostrarQr');
    const btnFecharQr      = document.getElementById('btnFecharQr');
    const btnJaPaguei      = document.getElementById('btnJaPaguei');

    const ebookArea        = document.getElementById('ebookArea');
    const ebookAviso       = document.getElementById('ebookAviso');

    const depoimentosGrid  = document.getElementById('depoimentosGrid');
    const formDepoimento   = document.getElementById('formDepoimento');
    const adminSenhaInput  = document.getElementById('adminSenha');
    const btnAtivarAdmin   = document.getElementById('btnAtivarAdmin');
    const adminStatus      = document.getElementById('adminStatus');
    const adminMediaButtons = document.getElementById('adminMediaButtons');

    const btnTrocarBanner  = document.getElementById('btnTrocarBanner');
    const btnTrocarProduto = document.getElementById('btnTrocarProduto');
    const btnTrocarQr      = document.getElementById('btnTrocarQr');

    const refCliente            = document.getElementById('refCliente');
    const btnGerarPagamento     = document.getElementById('btnGerarPagamento');
    const btnVerificarPagamento = document.getElementById('btnVerificarPagamento');
    const areaLinkPagamento     = document.getElementById('areaLinkPagamento');
    const linkPagamentoInput    = document.getElementById('linkPagamentoInput');
    const btnCopiarLink         = document.getElementById('btnCopiarLink');
    const btnAbrirLink          = document.getElementById('btnAbrirLink');

    // LOCALSTORAGE: chaves
    const STORAGE_KEY_DEP       = 'depoimentos_nicolly';
    const STORAGE_KEY_IMG       = 'heroPhoto_nicolly';
    const STORAGE_KEY_PROD_IMG  = 'produtoFoto_nicolly';
    const STORAGE_KEY_QR        = 'qrImage_nicolly';
    const STORAGE_KEY_EBOOK_OK  = 'ebookLiberado_nicolly';

    let isAdmin = false;
    const SENHA_ADMIN = 'nicolly2025';

    let ultimoLinkPagamento = null;
    let ultimaReferencia    = null;

    // ===== DEPOIMENTOS INICIAIS =====
    const depoimentosIniciais = [
      { id: 1, nome: 'Clara',        texto: 'Amei esse e-book, é maravilhoso!!' },
      { id: 2, nome: 'Suellen',      texto: 'Gente, é tão simples, meu Deus! Kkkk.' },
      { id: 3, nome: 'Patrícia',     texto: 'Porque eu não pensei nisso antes?' },
      { id: 4, nome: 'Elô',          texto: 'Muito bom, gostei bastante!' },
      { id: 5, nome: 'Marcio',       texto: 'Caramba, que massa! Kkkk.' },
      { id: 6, nome: 'Vizaura',      texto: 'Nossa senhora, Deus te abençoe, minha filha. Muito obrigada!' },
      { id: 7, nome: 'Suellen M.',   texto: 'Top, gostei muito, ficou mais fácil agora.' },
      { id: 8, nome: 'Igor',         texto: 'Massa pra caramba!' }
    ];

    function carregarDepoimentos() {
      const salvo = localStorage.getItem(STORAGE_KEY_DEP);
      if (!salvo) {
        localStorage.setItem(STORAGE_KEY_DEP, JSON.stringify(depoimentosIniciais));
        return depoimentosIniciais.slice();
      }
      try {
        return JSON.parse(salvo);
      } catch (e) {
        console.error('Erro ao ler depoimentos do localStorage, resetando.', e);
        localStorage.setItem(STORAGE_KEY_DEP, JSON.stringify(depoimentosIniciais));
        return depoimentosIniciais.slice();
      }
    }

    function salvarDepoimentos(lista) {
      localStorage.setItem(STORAGE_KEY_DEP, JSON.stringify(lista));
    }

    function renderizarDepoimentos() {
      const lista = carregarDepoimentos();
      depoimentosGrid.innerHTML = '';

      if (!lista.length) {
        depoimentosGrid.innerHTML =
          '<p class="text-gray-500 col-span-full">Ainda não há depoimentos cadastrados.</p>';
        return;
      }

      lista.forEach(function(dep){
        const card = document.createElement('div');
        card.className = 'p-6 bg-white rounded-2xl shadow relative';
        card.innerHTML = `
          <p class="italic text-gray-700">“${dep.texto}”</p>
          <p class="mt-3 font-semibold">— ${dep.nome}</p>
        `;

        if (isAdmin) {
          const btnDel = document.createElement('button');
          btnDel.textContent = 'Excluir';
          btnDel.className = 'absolute top-3 right-3 text-xs px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700';
          btnDel.addEventListener('click', function(){
            let lista = carregarDepoimentos();
            lista = lista.filter(function(d){ return d.id !== dep.id; });
            salvarDepoimentos(lista);
            renderizarDepoimentos();
          });
          card.appendChild(btnDel);
        }

        depoimentosGrid.appendChild(card);
      });
    }

    if (formDepoimento) {
      formDepoimento.addEventListener('submit', function(e){
        e.preventDefault();
        const nome = document.getElementById('nomeCliente').value.trim();
        const texto = document.getElementById('textoDepoimento').value.trim();
        if (!nome || !texto) return;

        const lista = carregarDepoimentos();
        const novoId = lista.length
          ? Math.max.apply(null, lista.map(function(d){ return d.id; })) + 1
          : 1;

        lista.push({ id: novoId, nome: nome, texto: texto });
        salvarDepoimentos(lista);

        formDepoimento.reset();
        alert('Depoimento enviado com sucesso!');
        renderizarDepoimentos();
      });
    }

    // ===== ADMIN UI =====
    function atualizarUIAdmin() {
      if (adminStatus) {
        adminStatus.innerHTML =
          'Modo admin: <span class="font-semibold">' +
          (isAdmin ? 'ativado' : 'desativado') +
          '</span>';
      }
      if (btnAtivarAdmin) {
        btnAtivarAdmin.textContent = isAdmin
          ? 'Desativar modo admin'
          : 'Ativar modo admin';
      }
      if (adminMediaButtons) {
        adminMediaButtons.classList.toggle('hidden', !isAdmin);
      }
    }

    if (btnAtivarAdmin) {
      btnAtivarAdmin.addEventListener('click', function(){
        const senha = adminSenhaInput.value.trim();
        if (senha === SENHA_ADMIN) {
          isAdmin = !isAdmin;
          atualizarUIAdmin();
          renderizarDepoimentos();
        } else {
          alert('Senha incorreta.');
        }
      });
    }

    // ===== UTIL: CARREGAR IMG DO LOCALSTORAGE =====
    function carregarImagemDoStorage(elemento, storageKey) {
      if (!elemento) return;
      const salva = localStorage.getItem(storageKey);
      if (salva) {
        elemento.src = salva;
      }
    }

    function bindUploadBotao(botao, inputFile, elementoDestino, storageKey, mensagemOk) {
      if (!botao || !inputFile || !elementoDestino) return;
      botao.addEventListener('click', function(){
        if (!isAdmin) {
          alert('Ative o modo admin para trocar esta imagem.');
          return;
        }
        inputFile.click();
      });

      inputFile.addEventListener('change', function(){
        const file = inputFile.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = function(e) {
          const dataUrl = e.target.result;
          elementoDestino.src = dataUrl;
          if (storageKey) {
            localStorage.setItem(storageKey, dataUrl);
          }
          if (mensagemOk) alert(mensagemOk);
        };
        reader.readAsDataURL(file);
      });
    }

    // Banner
    carregarImagemDoStorage(heroPhoto, STORAGE_KEY_IMG);
    bindUploadBotao(
      btnTrocarBanner,
      fotoInput,
      heroPhoto,
      STORAGE_KEY_IMG,
      'Foto do banner atualizada com sucesso!'
    );

    // Capa do e-book
    carregarImagemDoStorage(produtoFoto, STORAGE_KEY_PROD_IMG);
    bindUploadBotao(
      btnTrocarProduto,
      produtoFotoInput,
      produtoFoto,
      STORAGE_KEY_PROD_IMG,
      'Capa do e-book atualizado com sucesso!'
    );

    // QR Code
    carregarImagemDoStorage(qrImage, STORAGE_KEY_QR);
    bindUploadBotao(
      btnTrocarQr,
      qrInput,
      qrImage,
      STORAGE_KEY_QR,
      'QR Code atualizado com sucesso!'
    );

    // ===== MODAL DO QR CODE FIXO =====
    function abrirQr() {
      if (qrModal) qrModal.classList.remove('hidden');
    }
    function fecharQr() {
      if (qrModal) qrModal.classList.add('hidden');
    }

    if (btnMostrarQr) btnMostrarQr.addEventListener('click', abrirQr);
    if (btnFecharQr)  btnFecharQr.addEventListener('click', fecharQr);

    if (qrModal) {
      qrModal.addEventListener('click', function(e){
        if (e.target === qrModal) fecharQr();
      });
    }

    // ===== E-BOOK: LIBERAÇÃO (estado local + verificação real) =====
    function atualizarEstadoEbook() {
      const liberado = localStorage.getItem(STORAGE_KEY_EBOOK_OK) === '1';
      if (ebookArea && ebookAviso) {
        if (liberado) {
          ebookArea.classList.remove('hidden');
          ebookAviso.classList.add('hidden');
        } else {
          ebookArea.classList.add('hidden');
          ebookAviso.classList.remove('hidden');
        }
      }
    }

    // Botão "já paguei" usando QR fixo (sem validar no backend)
    if (btnJaPaguei) {
      btnJaPaguei.addEventListener('click', function(){
        localStorage.setItem(STORAGE_KEY_EBOOK_OK, '1');
        atualizarEstadoEbook();
        fecharQr();
        alert('E-book liberado! (QR fixo) Role até a seção do produto para baixar.');
      });
    }

    // ===== PAGAMENTO REAL VIA BACKEND =====
    async function criarPagamentoNicolly() {
      const ref = (refCliente.value || '').trim();
      if (!ref) {
        alert('Informe seu WhatsApp ou e-mail antes de gerar o link.');
        refCliente.focus();
        return;
      }
      try {
        const resp = await fetch(BACKEND_URL + '/pagamento/nicolly/preferencia', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ external_reference: ref })
        });
        const data = await resp.json();
        if (!resp.ok || !data.init_point) {
          throw new Error(data.detail || 'Não foi possível criar o link de pagamento.');
        }
        ultimaReferencia = ref;
        ultimoLinkPagamento = data.init_point;
        if (linkPagamentoInput) linkPagamentoInput.value = ultimoLinkPagamento;
        if (areaLinkPagamento) areaLinkPagamento.classList.remove('hidden');
        window.open(ultimoLinkPagamento, '_blank');
      } catch (err) {
        console.error(err);
        alert('Erro ao criar pagamento: ' + err.message);
      }
    }

    async function verificarPagamento() {
      const ref = (refCliente.value || '').trim();
      if (!ref) {
        alert('Informe o mesmo WhatsApp ou e-mail usado no pagamento.');
        refCliente.focus();
        return;
      }
      try {
        const resp = await fetch(BACKEND_URL + '/pagamento/status/' + encodeURIComponent(ref));
        const data = await resp.json();
        if (data.approved) {
          localStorage.setItem(STORAGE_KEY_EBOOK_OK, '1');
          atualizarEstadoEbook();
          alert('Pagamento aprovado! E-book liberado.');
        } else {
          alert('Ainda não encontramos pagamento aprovado para esse dado. Aguarde alguns segundos e tente novamente.');
        }
      } catch (err) {
        console.error(err);
        alert('Erro ao verificar pagamento: ' + err.message);
      }
    }

    if (btnGerarPagamento) {
      btnGerarPagamento.addEventListener('click', criarPagamentoNicolly);
    }

    if (btnVerificarPagamento) {
      btnVerificarPagamento.addEventListener('click', verificarPagamento);
    }

    if (btnCopiarLink) {
      btnCopiarLink.addEventListener('click', function(){
        if (!ultimoLinkPagamento) {
          alert('Gere o link primeiro.');
          return;
        }
        navigator.clipboard.writeText(ultimoLinkPagamento)
          .then(() => alert('Link copiado!'))
          .catch(() => alert('Não foi possível copiar o link.'));
      });
    }

    if (btnAbrirLink) {
      btnAbrirLink.addEventListener('click', function(){
        if (!ultimoLinkPagamento) {
          alert('Gere o link primeiro.');
          return;
        }
        window.open(ultimoLinkPagamento, '_blank');
      });
    }

    // Inicializações
    atualizarUIAdmin();
    atualizarEstadoEbook();
    renderizarDepoimentos();
   <script src="./produtos.js"></script>

  </script>

</body>
</html>
